<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabla de Stats</title>
    <style>
        body {
            font-family: 'Garamond', serif;
            background: transparent; /* Color de fondo claro */
            color: white; /* Color de texto claro */
            transition: background-color 0.3s, color 0.3s; /* Transición suave */
        }

        h2 {
            text-align: center;
            font-family: 'Garamond', serif;
            color: #643d1e;
        }

        table {
            width: 40%;
            margin: auto;
            border-collapse: collapse;
            background-color: #444; /* Fondo de tabla claro */
            color: white;
            border: 2px solid #643d1e;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.5);
        }

        th, td {
            border: 1px solid #f4f4f4;
            padding: 10px;
            text-align: center;
            font-family: 'Garamond', serif;
            color: #f4f4f4; /* Color de texto de tabla */
        }

        th {
            background-color: #555; /* Fondo de encabezados */
        }

        .stat-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }

            .stat-container input[type="number"] {
                width: 50px;
                text-align: center;
                border: 1px solid #643d1e;
                background-color: #555; /* Fondo de inputs */
                color: #f4f4f4;
            }

            .stat-container button {
                width: 30px;
                height: 30px;
                margin: 0 5px;
                font-size: 16px;
                background-color: #666; /* Fondo de botones */
                border: 1px solid #643d1e;
                cursor: pointer;
                color: #f4f4f4; /* Color de texto de botones */
            }

                .stat-container button:hover {
                    background-color: #d8c3a5; /* Fondo de botones al pasar el mouse */
                }

        .input-container {
            text-align: center;
            margin-bottom: 20px;
        }

            .input-container label {
                margin: 0 10px;
            }

            .input-container select, .input-container input[type="text"] {
                margin: 0 10px;
            }

        /* Estilos para el modo oscuro */
        body.dark-mode {
            background-color: #333; /* Color de fondo oscuro */
            color: #f4f4f4; /* Color de texto claro */
        }

            body.dark-mode table {
                background-color: #444; /* Fondo de tabla oscuro */
            }

            body.dark-mode th {
                background-color: #555; /* Fondo de encabezados oscuro */
            }

            body.dark-mode th, body.dark-mode td {
                border: 1px solid #f4f4f4; /* Color de borde claro */
                color: #f4f4f4; /* Color de texto de tabla */
            }

            body.dark-mode .stat-container input[type="number"] {
                background-color: #555; /* Fondo de inputs oscuros */
                color: #f4f4f4; /* Color de texto de inputs */
            }

            body.dark-mode .stat-container button {
                background-color: #666; /* Fondo de botones oscuros */
                color: #f4f4f4; /* Color de texto de botones oscuros */
            }
    </style>
</head>
<body>

    <h2>Tabla de Stats</h2>



    <div style="text-align: center; margin-bottom: 20px;">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" minlength="4" maxlength="15" required>
        <span id="nombreError" style="color: red; display: none;">El nombre debe tener entre 4 y 15 caracteres.</span>
    </div>

    <div class="input-container">
        <label for="raza">Raza:</label>
        <select id="raza">
            <option value="Humano">Humano</option>
            <option value="Montaras">Montaras</option>
            <option value="Yuguen">Yuguen</option>
            <option value="Sinhair">Sinhair</option>
            <option value="Amarant">Amarant</option>
            <option value="Alto Elfo">Alto Elfo</option>
        </select>

        <label for="sexo">Sexo:</label>
        <select id="sexo">
            <option value="Macho">Macho</option>
            <option value="Hembra">Hembra</option>
        </select>
    </div>

    <table>
        <thead>
            <tr>
                <th>Stats</th>
                <th>Puntos Base</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>FUE</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('FUE', -1)">-</button>
                        <input type="number" id="FUE" value="5" min="5" onchange="checkMinValue('FUE')">
                        <button onclick="adjustPoints('FUE', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>VIT</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('VIT', -1)">-</button>
                        <input type="number" id="VIT" value="5" min="5" onchange="checkMinValue('VIT')">
                        <button onclick="adjustPoints('VIT', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>AGI</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('AGI', -1)">-</button>
                        <input type="number" id="AGI" value="5" min="5" onchange="checkMinValue('AGI')">
                        <button onclick="adjustPoints('AGI', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>DES</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('DES', -1)">-</button>
                        <input type="number" id="DES" value="5" min="5" onchange="checkMinValue('DES')">
                        <button onclick="adjustPoints('DES', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>SIG</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('SIG', -1)">-</button>
                        <input type="number" id="SIG" value="5" min="5" onchange="checkMinValue('SIG')">
                        <button onclick="adjustPoints('SIG', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>PER</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('PER', -1)">-</button>
                        <input type="number" id="PER" value="5" min="5" onchange="checkMinValue('PER')">
                        <button onclick="adjustPoints('PER', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>CAR</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('CAR', -1)">-</button>
                        <input type="number" id="CAR" value="5" min="5" onchange="checkMinValue('CAR')">
                        <button onclick="adjustPoints('CAR', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>INT</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('INT', -1)">-</button>
                        <input type="number" id="INT" value="5" min="5" onchange="checkMinValue('INT')">
                        <button onclick="adjustPoints('INT', 1)">+</button>
                    </div>
                </td>
            </tr>
            <tr>
                <td>MAG</td>
                <td>
                    <div class="stat-container">
                        <button onclick="adjustPoints('MAG', -1)">-</button>
                        <input type="number" id="MAG" value="5" min="5" onchange="checkMinValue('MAG')">
                        <button onclick="adjustPoints('MAG', 1)">+</button>
                    </div>
                </td>
            </tr>
        </tbody>
        <tfoot>
            <tr>
                <td>Total de Puntos Agregados</td>
                <td id="total">0</td>
            </tr>
        </tfoot>
    </table>
    <div style="text-align: center; margin-top: 20px;">
        <button onclick="downloadStats()">Descargar Stats</button>
    </div>

    <div style="text-align: center; margin-top: 20px;">
        <button onclick="downloadStats('bbcode')">Descargar en BBCode</button>
    </div>



    <script>
            // Diccionario con los stats mínimos por raza
            const razaStats = {
                "Humano": { FUE: 5, VIT: 5, AGI: 5, DES: 5, SIG: 5, PER: 5, CAR: 5, INT: 5, MAG: 5 },
                "Montaras": { FUE: 20, VIT: 15, AGI: 15, DES: 5, SIG: 5, PER: 5, CAR: 5, INT: 5, MAG: 5 },
                "Yuguen": { FUE: 5, VIT: 5, AGI: 15, DES: 5, SIG: 5, PER: 20, CAR: 5, INT: 5, MAG: 15 },
                "Sinhair": { FUE: 5, VIT: 5, AGI: 15, DES: 20, SIG: 5, PER: 5, CAR: 5, INT: 5, MAG: 15 },
                "Amarant": { FUE: 15, VIT: 15, AGI: 20, DES: 5, SIG: 5, PER: 5, CAR: 5, INT: 5, MAG: 5 },
                "Alto Elfo": { FUE: 5, VIT: 5, AGI: 5, DES: 5, SIG: 5, PER: 15, CAR: 5, INT: 15, MAG: 20 }
            };

            let totalPuntosAgregados = 0;

            // Función para ajustar los stats al seleccionar la raza
            document.getElementById("raza").addEventListener("change", function() {
                const selectedRaza = this.value;
                const stats = razaStats[selectedRaza];

                for (let stat in stats) {
                    const input = document.getElementById(stat);
                    input.min = stats[stat]; // Establece el valor mínimo basado en la raza
                    input.value = stats[stat]; // Asigna el valor base de la raza
                }

                // Reiniciar el total de puntos agregados al cambiar de raza
                totalPuntosAgregados = 0;
                document.getElementById("total").textContent = totalPuntosAgregados;

                updateTotal();
            });

            // Función para ajustar los puntos de los stats
            function adjustPoints(stat, adjustment) {
                const input = document.getElementById(stat);
                const minStatValue = parseInt(input.min); // Valor mínimo basado en la raza
                let newValue = parseInt(input.value) + adjustment;

                if (newValue >= minStatValue) {
                    input.value = newValue;

                    // Solo sumar al total si se agregan puntos adicionales sobre los valores base
                    if (adjustment > 0) {
                        totalPuntosAgregados += adjustment;
                    } else if (adjustment < 0 && totalPuntosAgregados > 0) {
                        totalPuntosAgregados += adjustment;
                    }

                    document.getElementById("total").textContent = totalPuntosAgregados;
                    updateTotal();
                }
            }

            // Función para verificar que el valor de un stat no baje del mínimo permitido
            function checkMinValue(stat) {
                const input = document.getElementById(stat);
                const minStatValue = parseInt(input.min);

                if (parseInt(input.value) < minStatValue) {
                    input.value = minStatValue;
                }

                updateTotal();
            }

            // Función para actualizar el total de puntos
            function updateTotal() {
                const stats = ["FUE", "VIT", "AGI", "DES", "SIG", "PER", "CAR", "INT", "MAG"];
                let total = 0;
                stats.forEach(stat => {
                    const baseValue = parseInt(document.getElementById(stat).value) || 5;
                    const initialBase = parseInt(document.getElementById(stat).min);
                    total += Math.max(0, baseValue - initialBase);
                });
                document.getElementById("total").textContent = total;
            }

            // Función para descargar los stats
        function downloadStats() {
            const nombre = document.getElementById("nombre").value;
            const raza = document.getElementById("raza").value;
            const sexo = document.getElementById("sexo").value;

            if (nombre.length < 4 || nombre.length > 15) {
                document.getElementById("nombreError").style.display = "inline";
                return;
            } else {
                document.getElementById("nombreError").style.display = "none";
            }

            const stats = ["FUE", "VIT", "AGI", "DES", "SIG", "PER", "CAR", "INT", "MAG"];

            // Formato de texto plano
            let txtData = `Nombre: ${nombre}\nRaza: ${raza}\nSexo: ${sexo}\nStat: Valor\n`;
            // Formato BBCode
            let bbcodeData = `[center][i]Nombre:[/i][b]${nombre}[/b][/center] \n[center][i]Raza:[/i][b]${raza}[/b][/center] \n[center][i]Sexo:[/i][b]${sexo}[/b][/center] \n[center][i]Stats:[/i][b]Valor[/b][/center]\n`;

            stats.forEach(stat => {
                const value = document.getElementById(stat).value;
                txtData += `${stat}: ${value}\n`;
                bbcodeData += `[center][i]${stat}:[/i][b]${value}[/b][/center] \n`;
            });

            // Crear archivo .txt
            downloadFile(txtData, 'stats.txt', 'text/plain');

            // Crear archivo .bbcode
            downloadFile(bbcodeData, 'stats.bbcode', 'text/plain');
        }

        // Función auxiliar para descargar archivos
        function downloadFile(data, filename, type) {
            const blob = new Blob([data], { type });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            a.click();
            URL.revokeObjectURL(url);
        }


            // Inicializar los valores por defecto al cargar la página
            document.addEventListener("DOMContentLoaded", function() {
                const raza = document.getElementById("raza").value;
                if (raza) {
                    const stats = razaStats[raza];
                    for (let stat in stats) {
                        const input = document.getElementById(stat);
                        input.min = stats[stat]; // Inicializa el valor mínimo
                        input.value = stats[stat]; // Inicializa los valores de los stats
                    }
                }
            });
    </script>
</body>
</html>
